Based on a modified version of the LSPC library from: https://github.com/kdhansen/LSPC
